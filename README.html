<html>
    <head>
        <title>CreateAnims Docs</title>
        <style>
            body {
                width: 100%;
                color: #444;
                margin: 0;
                font-family: 'Lato', sans-serif;
                line-height: 1.6em;
            }

            ul {
                margin-left: 40px;
            }

            dt {
                font-weight: bold;
                margin-top: .33em;
                margin-left: 2.5em;
            }

            h2 {
                color: #000;
                margin-left: 0;
            }

            h3 {
                color: #000;
                margin-left: 1em;
            }

            h4 {
                margin-left: 2.5em; /*Same as paragraphs.*/
            }

            p {
                margin-left: 2.5em;
            }

            .banner-divider {
                position: relative;
                height: 40px;
            }

            .content {
                width: 960px;
                margin: 0 auto;
                box-sizing: border-box;
                background: #fff;
                box-shadow: 0 0 15px rgba(0, 0, 0, .3);
            }

            .inner-content {
                padding: 0 20px 40px;
            }

            .editsection {
                display: none;
            }
        </style>
    </head>
    <body>
        <div class="content">
            <div class="banner-divider"></div>
            <div class="inner-content">
                <h2>Introduction</h2>
                <p>
                    The idea behind CreateAnims is to ease the edition of binary files which otherwise are hard to edit and see the impact of the changes immediately. And it was originally intended for MK3. 
                    
                    <br><br>Before CreateAnims, to change the length of the idle animation for example (which in the original game is quite fast), we would have to find the corresponding physics row in the ROM (no binary files per se), add/remove the bytes and make sure we remove them in pairs (X and Y) which made it highly error-prone, and then modify the values, always keeping in mind that for negatives, we need to use 2's complement. And then we needed to go character by character adding the necessary frames. All of those details were abstracted in CreateAnims, which means all you have to do is Edit physics, add the corresponding columns, see the immediate effects of your changes in the graph, and then you can navigate from character to character adding the necessary frames. And if there's any error or inconsistency between the physics and the frames, this is reported.

                    <br><br>The same goes for other kinds of changes. If you wanted to change Stryker's throw animation for example, to extend the length of some frames, you would have to go to the corresponding character's file. Then modify the values and <em><strong>*hope*</strong></em> (this word is key, and was annoying even for me) that you're modifying the correct values. Because all you see is numbers, and I do have a list on what some numbers mean but I still can't <em><strong>*see*</strong></em> it (this is the other key word). So you want to insert some frame but you don't know the number and you need to put breakpoints and stuff in the emulator to find out, or go through your lists... it's not straightforward.

                    <br><br>For programmers, I don't think this is that bad of an issue after you get used to it, but the idea is that non-programmers like people focused on graphics, that they can add animations, extend/remove frames etc. etc. and everything without having to fully understand the details behind the scenes, under the hood. And without having to exchange a lot of files for every single change, and be like oh there's this thing here missing, there's this other, and stuff like that.

                    <br><br>So you could say the main reason behind CreateAnims and the target for CreateAnims are non-programmers who still want to add new animations to game, modify existing animations and all of this without going through the harsh processes I described above.
                    (plus, it was a lot of fun and I always wanted to do something like this, to go through the experience.)

                    <br><br>That's it. So on with the explanation on the features! Let's get started!
                </p>

                <h3>Contents</h3>
                <p>
                    I will divide the contents by actions you can take in each section (the menus, the stage, the palette and so on and so forth). If something can be done multiple ways (for example, clicking on a button, using the arrow keys, using a keyboard shortcut), I will clarify it but I will leave the action associated to the section that makes more sense to me:
                </p>

                <dl>
                    <dt><a href="#Getting Started">Getting Started</a></dt>
                    <dd>Learn about what you'll see when you first open CreateAnims and how to get into the animations!</dd>
                    <dt><a href="#Anim Stage">Anim Stage</a></dt>
                    <dd>The portion you see at the top, just below the menus.</dd>
                    <dt><a href="#Palette">Palette</a></dt>
                    <dd>The portion just below the Anim Stage, at the left. Allows you to modify the palette used for the character.</dd>
                    <dt><a href="#CHR">CHR</a></dt>
                    <dd>The portion just below the Anim Stage, at the right, next to Palette.</dd>
                    <dt><a href="#Anim Command Base">Anim Command Base</a></dt>
                    <dd>You can modify all animation and frame-related here. Like current character, frame, animation etc. etc.</dd>
                    <dt><a href="#Physics">Physics</a></dt>
                    <dd>A new window opens and shows a graph of what the current animation looks like in terms of movement. You can edit coordinates as well.</dd>
                    <dt><a href="#UndoRedo">UndoRedo</a></dt>
                    <dd>Actions related to redoing and undoing stuff, including my shiny makes-me-proud Switch Branch.</dd>
                    <dt><a href="#Import">Import</a></dt>
                    <dd>Accessible only via the menu. Allows to import all file types (.chr, .chr.pal, .frame, .anim, .pal and .physics)</dd>
                    <dt><a href="#Save">Save</a></dt>
                    <dd>Individual save accessible only via the menu, Save Changes accessible also via keyboard shortcut.</dd>
                    <dt><a href="#Tools">Tools</a></dt>
                    <dd>Tools added to ease either debugging crashes in CreateAnims (let's hope there aren't as much! but if there are please report them!) or understanding the actions taken, or both.</dd>
                    <dt><a href="#Additional Commands">Additional commands</a></dt>
                    <dd>Stuff that doesn't fit in any of the other sections but that can help make using CreateAnims smoother. Alternative names: usage tips (in the sense that it's advisable or recommended to use the commands described in this section), usage helpers.</dd>
                    <dt><a href="#Internals">Internals/Special considerations</a></dt>
                    <dd>In case you have to build the data for your game, details on the internals of CreateAnims might help you to make the necessary modifications to make it work.</dd>
                </dl>

                <p><b>WARNING</b>: You can see the updated shortcuts by going through the menu and then taking a look at the shortcut displayed to the right of the text. I will do my best to keep the docs in sync but if on doubt, CreateAnims has the final word as for the correct shortcut.</p>

                <h3 id="Getting Started">Getting Started</h3>
                <p>
                    When CreateAnims first starts, a default directory with a default character (character_x) will be created. You will see a folder CreateAnims_DefaultDirectory being created, but please don't mess with it (I can see you now messing with it). It contains an example structure which you can also use as inspiration or to get a more, graphical, visual idea? of how to get a folder working with the data in your game. There's also the File Format subsection in Internals section which I recommend more for the details but, you know, both can help.

                    <br><br>To open the directory with your data, click on <b><em>Open Characters Directory</em></b> in the File Menu.
                </p>

                <h3 id="Anim Stage">Anim Stage</h3>
                <p>
                    When CreateAnims first starts (or when you first open a directory), you will see a character drawn with a red rectangle around it (showing the boundaries of the frame) and then blue rectangles highlighting the empty $FF tiles.

                    <br><br>The idea here is that you can easily determine how big the frame actually is (sometimes, the frame is pretty big but only a few portions contain sprites, which can be useful to then free memory) and at the same time you can easily spot the available spaces by looking at the empty $FF tiles.

                    <br><br>You can toggle those with the following keyboard shortcuts and also via the Anim menu:</p>
                    <ul>
                        <li><b><em>Shift+T</em></b>: Toggle transparency. If on, won't draw any specific color for transparent pixels. If off, will draw black (as additional info, transparency is always off for CHR). Default: True (show transparency).</li>
                        <li><b><em>r</em></b>: Toggle (red) rectangle around frame. If on, a red rectangle will be drawn about the frame highlighting the boundaries of the frame. Default: True.</li>
                        <li><b><em>e</em></b>: Toggle draw empty cells (blue rectangles). In other words, the empty $FF tiles. If on, will draw them in blue. Default: True.</li>
                    </ul>
                    <p>Actions you can take on the frame itself (not by using the buttons and interface in the Anim Command Base, that will be expanded on another section below):</p>
                    <ul>
                        <li><b><em>Left click</em></b>: Select a tile. If there is a CHR tile selected, it will update the tile in the frame with that of the CHR. Otherwise doesn't do anything on its own other than changing the selection in the frame. Hold to apply the same to more tiles.</li>
                        <li><b><em>Right click</em></b>: Select a tile in both the frame and the CHR. Doesn't do anything on its own other than changing the selection.</li>
                        <li><b><em>Double right click</em></b>: Empty the selected tile (i.e. turn it into an empty $FF tile). Hold to apply the same to more tiles.</li>
                        <li><b><em>Shift + left click</em></b>: Select one portion of the frame. Useful for moving stuff around in the frame (you can increase width or height, and then move).</li>
                    </ul>

                <h3 id="Palette">Palette</h3>
                <p>
                    There's two sections of colors: the upper one distinguishes the character's palette (8 colors total counting the background). The bottom one is a color picker where you can choose new colors from to update the character's palette.

                    <br><br>To update the character's palette, select first the index you wish to update (for example, color in position 1, position 2, etc.) and then select the color you want to update it to. The changes will apply immediately.

                    <br><br>You can also hover over the colors to see what they're set to or what their values are (palette values are always displayed in hex as at least to me they seem more readable that way). Do keep mind the value shown in the Palette field always reflects the hover and not the selection, except for when you update the color for the character's palette. Also the hover applies only for the character's palette, not the color picker (but it follows rows system, from $00 to $0F one row, from $10 to $1F the other row and so on and so forth).

                    <br><br>One more thing: while technically, an update on the 5th palette should also update the 1st palette (because they're both the background color), they're considered different colors here. It doesn't really make a difference, but you could use it for example for testing out of fun how tiles look with a different background color other than black, and then do the same for the group of tiles that use the other palette group.
                </p>
                <h3 id="CHR">CHR</h3>
                <p>
                    There's the CHR bank field which shows the currently selected CHR bank, and then there's a rectangle portion showing all the CHR in the currently selected 2K of CHR. Every character uses 2K of the total 4K for sprites in the same way that every character uses 8 colors out of the total 16 for the palette.

                    <br><br>There's also a CHR Info which will show some information depending on the changes you make or try to make (there are validations in place, as there are things you can't do!). Information is displayed in <span style="color:blue">blue</span>, and validation errors are displayed in <span style="color:red">red</span>.

                    <br><br>To change the currently selected CHR, you can either enter the new value in the entry field, or use the arrows. Notice the navigation here is on steps of 2 because each unit refers to 1K of CHR and each character has 2K of CHR loaded at a time. Also, when you update the CHR, the frame data will be automatically updated to reflect this new value, so the frame will be redrawn accordingly.

                    <br><br>Actions you can take on the CHR rectangle: </p>
                    <ul>
                        <li><b><em>Left click</em></b>: Select a tile. Doesn't do anything on its own other than changing the selection in the CHR.</li>
                        <li><b><em>Double left click</em></b>: Toggle the tile's palette. Tiles can use palette group 0 or 1 (remember one tile can use only 4 colors at a time including the background or also called backdrop color, which is the transparency), and this toggles it. Sprite priority stuff is not considered here, those will be highly specific to the game in question.</li>
                        <li><b><em>Double right click + drag</em></b>: Toggle the palette for all tiles as you move the mouse while right clicking. Keep in mind that until you release, you cannot toggle the palette for an already toggled tile. If you regret your decision, you can either undo (more details on the respective section) or double right click again (or you could also just double left click to apply the change on just one tile or a few tiles).</li>
                        <li><b><em>Shift + left click</em></b>: Select one portion of the CHR. Useful for then pasting into the frame.</li>
                    </ul>
                <p>
                    To add new CHR, first make sure the CHR bank really is empty. I could add a check to see if the CHR bank is used maybe by another character but either way it'll be up to the user to check if the CHR bank is being used for other purposes like stages for example. You will also get this information in blue when you encounter an empty CHR bank for the currently selected character. How it works is that CreateAnims checks the ID in each .chr file, and if the new ID is not present in those, then it is considered new. But again, you have the final word on whether that's true or not.

                    <br><br>Here's the intended workflow: you make the CHR in an external tool like YY-CHR. Then you search for free CHR space in the ROM. You identify the bank number. Then you enter it in CreateAnims for the character you want to associate the CHR to. You import the CHR. And now when you save, you can either save the CHR individually or you can use Save Changes and it will create the CHR file in the characters directory (you may have to manually update CHR palette, but you can do all of that within CreateAnims). For sure, there will still be some file exchanges between programmers and graphics team but you can do all the file creation in CreateAnims and then just send the files to the programming team. It simplifies the workflow and exchange, it doesn't remove it entirely, and that's fine, work as a team!

                    <br><br>Also, <u>as a reminder</u> (I will say this a lot so if you've already read it feel free to skip it), adding new CHR doesn't mean you'll see it right away in the ROM. The new file will be created, but it's up to the user to add it to the ROM wherever there is free space and then to configure everything to be able to use the newly added data.
                </p>
                <h3 id="Anim Command Base">Anim Command Base</h3>
                <p>
                    Get ready! This is your Anim Command Base!

                    <br><br>There are many buttons and fields here though I tried to keep it as simple as possible and I'm including other potential changes as settings or checkboxes. Anyways, in general they all work the same way as CHR bank does. You have an entry where you can input a value and then press Enter and it'll be processed right away. Or, you can click on the arrows and it will be processed right away too.

                    <br><br>Worth noting is the difference between navigation and change, though I'll cover the details of that in the <a href="#UndoRedo">UndoRedo</a> section. But for example, the Anim, Frame and Character fields are navigation, not changes. Which means, when you go from Anim 00 to Anim 20 for example, a new frame is drawn according to whatever frame ID is set for frame 00 of the selected anim, but no files are affected because, well, you aren't changing anything, you're just navigating.

                    <br><br>Here's a breakdown of what each field means:</p>
                    <h4>Animation-related</h4>
                    <ul>
                        <li><u>Anim</u>: The currently selected animation. Every character has animations (states) in which they can be.</li>
                        <li><u>Frame</u>: The frame where we are in the currently selected animation. Every state in the animation has something to draw. Each singular state is the frame.</li>
                        <li><u>Frame ID</u>: And what to draw at that frame is the frame ID. For example, you could have Frame ID 01 for frames 0 to 3. That means, for states 0 to 3 of the current animation, draw the same frame 01. In other words, you can extend the length a frame is shown by adding the same frame ID to different frames of the animation.</li>
                        <li><u>Physics ID</u>: The physics the animation uses. Please keep in mind, those affect <em><strong>*every*</strong></em> character in the game. I'll say that again: <em><strong>*every*</strong></em> character. If I had to guess why it was designed that way, I'd say to make reuse easier. In general, except for special abilities, every animation has the same physics for every character. Every character walks at the same speed, jumps the same amount of X and Y etc. etc. So this is more of usage tips which I will include below but for new abilities, you'll most likely need a new physics ID too that will be exclusive to that character.</li>
                    </ul>

                <p>
                    You can add physics IDs that are unique to one character and one anim. But you have to enforce that, like, keep a list of what should be unique and what should not. CreateAnims cannot know this, as some physics IDs are meant to be shared, others are not. That is your decision to make.

                    <br><br>Also, if the amount of frames in the physics doesn't match the amount of frames in the animation, you'll get a warning (there's a very high chance you'll see graphical bugs in the ROM and inconsistencies with what is shown in CreateAnims). This warning can help you catch bugs: in MK3, there are quite a few characters with this issue like Liu Kang when it does a low spinning kick. And with this warning, you catch it immediately.
                </p>
                    <h4>Frame-related</h4>
                    <ul>
                        <li><u>X Offset</u>: It's the distance in X from the current X player position. If you're familiar with video game development this might be already familiar to you but in summary there are situations where you want pixel-accurate positioning and only offsets can give you that (width and height are always in units of 8). Offsets also allow for stuff like collisions and hitboxes/hurtboxes, like you see the character or projectile in one position but it's actually in another, can help in platformer games for stuff like spikes, your character was already on spikes but the collision didn't detect it because the drawing is far ahead, stuff like that.</li>
                        <li><u>Y Offset</u>: Same as X offset, but for Y. Internally it is handled differently than X offset but the concept is the same.</li>
                        <li><u>Width</u>: How many 8x8 boxes from the starting position (always left unless sprites are flipped). Valid values only from 1 onwards in other words positive integers different from zero.</li>
                        <li><u>Height</u>: How many 8x8 boxes from the starting position and upwards.</li>
                    </ul>

                <p>
                    One way to look at it is that width*height = total amount of tiles (including empty $FF tiles).
                </p>
                    <h4>Additional fields</h4>
                    <ul>
                        <li><u>Character</u>: The ID of the selected character. Beware, this will not necessarily match the ID as known in-game. CreateAnims assigns the ID based on the order found when traversing the folders in the character directory. In the future (and perhaps as you're reading this), I plan to add an option for this.</li>
                    </ul>
                    <h4>Buttons</h4>
                    <ul>
                        <li><u>Play Anim</u>: Starts playing the currently selected anim from frame 00. If you were on frame 03 for example when you started playing the anim, this state will be restored when you click on 'Stop Anim' (meaning, you can go back to the frame you were modifying for example). Keep in mind a framerate of 20FPS is assumed. And, you can't do edits of any kind while playing an anim. You will get messages if you do. Avoid them!</li>
                        <li><u>Stop Anim</u>: Stops playing the currently playing anim. Allows you to go back to edition.</li>
                        <li><u>Edit Physics</u>: Opens the Create Anims Physics Manager. More on that in the section immediately below.</li>
                    </ul>
                    <p>
                        If there's a physics ID mismatch (you will get a warning), which happens when the amount of frames in the animation doesn't match the amount of frames in the physics ID, play anim will remain enabled, but without physics.
                    </p>
                    <p>Additionally, by <b><em>Right click</em></b> on the following entries, you can:</p>
                    <ul>
                        <li><b><em>Anim</em></b>: Create a New Anim. You cannot remove existing ones (more details below).</li>
                        <li><b><em>Frame</em></b>: Insert a frame at that point, or remove the current selected frame.</li>
                        <li><b><em>Frame ID</em></b>: Create a New Frame ID. You cannot remove existing ones (more details below).</li>
                        <li><b><em>Physics ID</em></b>: Create a New Physics ID. You cannot remove existing ones (more details below).</li>
                    </ul>
                    <p>You cannot remove existing frames, frame IDs and physics IDs because it could cause a lot of problems in the ROM. It's not an implementation problem (it's relatively simple code-wise, given one specific ROM), but more a matter of actually removing something from the ROM, which specifics might vary. So I prefer to leave it to the user. You can still Undo the additions.</p>
                <h3 id="Physics">Physics</h3>
                <p>
                    Physics are what give anims movement. Anims on themselves don't move. They might give the illusion of moving due to the changes in Y and X offsets, but they aren't moving. Technically speaking, without physics, the images are always placed at the exact same location. So that's what I mean when I say that they don't move (I do agree that we could argue they do move based on the definition we take, but under this definition, no, they don't move without physics).

                    <br><br>The idea behind is again to have a clearer visualization of how a new ability is going to look, for example. Or how walking is going to look, if you wanted to adjust speed for example. This goes for everything, for MK3 it goes for fatalities as well, potential brutalities and a long etcetera. You can take a look at the graph also to get an idea of how it looks from a graph perspective.

                    <br><br>To edit physics, click on 'Edit Physics' button and a new Physics Window will open (the Create Anims Physics Manager).
                </p>

                <h4>Create Anims Physics Manager</h4>
                <p>
                    When it first opens, it will show you a graph showcasing with red dots the movement of the current anim, along with green lines that connect them. Below the graph, you will see a table where you can see how the physics change per animation frame.

                    <br><br>A positive value in X means <em>forwards</em>, that is, <em>rightwards</em>. A negative value in X means <em>backwards</em>, that is, <em>leftwards</em>.
                    <br><br>A positive value in Y means <em>downwards</em>. A negative value in Y means <em>upwards</em>.

                    <br><br>Physics value -128 is not valid for X. This is because 0x80 (-128) is the physics terminator.

                    <br><br>Every physics is assumed to start at a point where it cannot go downwards (the center). This is because usually every animation always moves upwards and then downwards but never downwards from the start. Exceptions would be special moves where the character goes down through the ground, but even those can be correctly displayed in the table, just nothing will be shown below.
                
                    <br><br>Actions you can take on frames in the table:</p>
                    <ul>
                        <li><b><em>Right click</em></b>: Removes the frame.</li>
                        <li><b><em>Shift + Right click</em></b>: Inserts a new frame immediately afterwards. For example, if the physics has 6 frames and you Shift + Right click on frame 4, a new frame will be inserted between frame 4 and frame 6.</li>
                        <li><b><em>Shift + Left click</em></b>: Opens the Physics Dialog where you can update X and Y values for that frame. When the window first opens, X is selected so you can quickly enter a value and then press enter to see the changes in the graph right away. You can also press tab and then enter a value for Y to enter new values for both quickly.</li>
                    </ul>
                <h3 id="UndoRedo">UndoRedo</h3>
                <p>
                    UndoRedo allows you to undo actions that you regret deeply in your heart, or maybe actions that you simply regret, or you want to update something, and maybe you want to go back to previous state because you just wanted to peek at something but that's all so now you want to redo... stuff like that. I mean, I think everyone uses UndoRedo? Ok but still, if you didn't know, now you do :D .

                    <br><br>Here's how it works: you start at point 0. Then, as you do stuff, you go from one point to the other, or in other words from one state to the other. So state 0, state 1, state 2 etc. etc., and every time you undo, you go back to the previous state, and every time you redo, you go to the next state (so yes, you can only redo if you first undid). This is what I call the UndoRedo.
                    <br><br>How to navigate through the UndoRedo: </p>
                    <ul>
                        <li><b><em>Ctrl+Z</em></b>: Undo the last operation. You can also go to Edit menu and then click on Undo.</li>
                        <li><b><em>Ctrl+Y</em></b>: Redo the last operation. You can also go to Edit menu and then click on Redo.</li>
                        <li><b><em>Ctrl+Shift+Z</em></b>: Switch branches. You can also go to Edit menu and then click on Switch Branch.</li>
                    </ul>
                <p>
                    For physics specifically, sometimes it might feel like the Undo or the Redo didn't do anything if you imported a physics file (I couldn't find an usecase for this but hey, you can still do it). This is expected and to see the changes you need to go into Edit physics. The reason why it happens is because when you do the import, the physics file is internally modified but it's not visible in any way. I could add a messagebox if people wanted it but I thought it shouldn't happen very often (key word shouldn't) and in a lot of cases you'll probably get the warning which will let you know there was a change in physics. But still, I'm putting it here as a heads up.

                    <br><br>For things you can do, there's navigation and there's change. However both are considered for the UndoRedo. Meaning, if you navigated from one anim to the other or from one character to the other, you will be able to Ctrl-Z/Undo that. But only the changes will be considered for the Save (more on that in the Save section). And, not absolutely everything is saved, for example selection changes are not saved (so if you click on one palette then another, this is not saved, same if you click on one tile in the CHR and then another, this is not saved).
                </p>
                <h4>Switch Branch</h4>
                <p>
                    So I'd like to expand a bit more on Switch Branch. The idea behind is, haven't you ever encountered yourself in a situation where you were undoing something, you wanted to see how stuff was at that point, but then you wanted to go back, but then you accidentally make a change, and you're unable to go back?! That's a terrible situation to be in, and I said to myself, I will change things!

                    <br><br>You can only Switch Branch if there actually is another branch. So you need to be in a situation like the one I described. You make some changes, you go back, and now you do other changes, then you have two branches: one with your original changes, another with your new changes, and, you also have a common point: the point where they diverged. The point where the two branches were created. So, if there are 2 branches, and you Switch Branch, you will be taken back to the common point. If you again Switch Branch, you will remain in the common point but CreateAnims will now be pointing at the other branch, meaning that a Redo will take you through the other branch. Because of the nature of the Switch Branch, you can only actually do it if you're at the common point or after. You cannot do it from before that.

                    <br><br>Also please keep in mind you can have a maximum of 2 branches at a time. If you again make some other changes after Switch Branch'ing, your changes will be lost. In this sense, do keep in mind that if you save changes, you go back say 2 steps, and do new changes, and then Switch Branch and do more changes, you will be unable to go back to the last saved point! And also to any intermediary step, like if you went 2 steps backwards originally, you'll be unable to go to the 1 step previous to the saved point. This is the same way that pretty much every tool with UndoRedo works, but, in CreateAnims you have the Switch Branch which makes it harder for you to end up in a situation like that. I wish this feature was more popular.

                    <br><br>You can click on <b><em>Switch Branch</em></b> in the Edit menu or use keyboard shortcut <b><em>Ctrl+Shift+Z</em></b>.
                </p>
                <h3 id="Import">Import</h3>
                <p>
                    Import is specially meant for CHR, but can be used for all other types of files. Say you detected a frame in another game and you want to see how it looks here, you can do that. Same with an anim, or a CHR palette, etc. etc.

                    <br><br>You can only access the import options via the Import menu.
                </p>
                <h3 id="Save">Save</h3>
                <p>
                    You can save individual files, or save all changes as you do them. In the case of the latter, new files will be created in case you added anything new (like new CHR for the currently selected character).

                    <br><br>You can save all changes by using the keyboard shortcut <b><em>Ctrl+S</em></b> or by clicking on <b><em>Save changes</em></b> in the File menu. When you do, a new Save changes window opens, highlighting in two blocks:</p>
                    <ul>
                        <li><u>Changes about to be saved</u>: Shows the changes (excludes navigation) done since last save until now (if CreateAnims was just opened, last save means the state when you just opened it). In case you do changes, then undo those, these will be removed from this list as well. For a complete list of what you did, you can check the Log History tool.</li>
                        <li><u>Affected files</u>: Shows the detected affected files. Only those files are touched and overwritten (or created in the case of additions). You will be asked to confirm.</li>
                    </ul>
                <p>
                    When you first start CreateAnims, the title will be Create Anims, but will expand to Create Anims - Saved when you save and don't make any other changes. If you do changes (including Undo/Redo if applicable), you'll see Create Anims - Unsaved changes.
                </p>
                <h4>Refresh to Last Saved</h4>
                <p>
                    This is meant for situations like the one I described in Switch Branch section (I think it was there), but taken one step further, you could say.

                    <br><br>Suppose you changed 5 frames for one anim, saved the changes, then undid 3 of those, and now did another, a 6th frame change. At this point, you could Switch Branch to go back to the 5 frames change branch. And you could go back and forth to either include the 6th change in the 5 frames branch, or maybe copy the 6th frame change to a modified 5th, or simply go back if it was an accident, and potentially other uses, but those two are the ones for what Switch Branch is there (specially the accidental one, had that happen a bunch of times with other programs and I wish, I deeply, heartedly wish more programs had this feature, so here I made it). At this point, a Switch Branch has you covered.

                    <br><br>But suppose now that you made yet another change. Suppose that you went back to the 3rd frame, and changed another frame, a 7th frame. Now, you absolutely <em>cannot</em> go back, no matter how hard you wish for it. You can, however, copy the Log History (highly, highly recommended, it's there for debugging and scenarios like this) and then... wal√°, you guessed it. Refresh to Last Saved.

                    <br><br>Refresh to Last Saved will reload <em><strong>all</strong></em> characters and <em><strong>clear</strong></em> the UndoRedo. What this means is that Refresh to Last Saved is <em><strong>IRREVERSIBLE</strong></em>. You will get a log though, saying that a Refresh was done, and you will still be able to access the rest of the history, but I still recommend it copying it before, but yeah you can also do it later if you wanted and needed it. Perhaps, you just regret your latest changes and really want to start again from a blank page. You could of course just restart CreateAnims, but why when you can just refresh? So that's the other scenario where it's pretty cool.

                    <br><br>Do note, however, that Refresh to Last Saved doesn't apply for navigations. What this means is that if you navigated from a character to another character for example, and you hit Refresh to Last Saved, you will see a popup telling you the changes wouldn't have any effect. What this means is that there won't be any effects from changes perspective, which is what the Refresh to Last Saved is meant for. If you wish to return to that state, you can Undo until that point. Though, you can still end up in a situation like the one I described with only navigations. So, if you would prefer to have Refresh to Last Saved enabled also in these cases, do let me know and I'll modify it. For now I like that it tells you all from changes perspective.

                    <br><br>To use, click on <b><em>Edit->Refresh to Last Saved</em></b>, or do <b><em>Ctrl+R</em></b>.
                </p>
                <h3 id="Tools">Tools</h3>
                <h4>Log History</h4>
                <p>
                    Shows every single navigation and change you did (yes, every single one! don't keep any secrets!). The Log History is meant as both a debugging and to-be-used-as-you-use-CreateAnims tool, for tracking purposes and stuff. As such, in case CreateAnims crashes (hope it doesn't happen! but if it does, please report it!), a file <em>crash_log.txt</em> will be created and will include the error description along with the Log History, to have a broader context on what exactly could have made it crash. It can also help to understand behavior that may be not expected, but that is still correct considering the technicalities of how it works.

                    <br><br>To access it, use keyboard shortcut <b><em>Ctrl+L</em></b> or click on <b><em>Log History</em></b> in the Tools menu.

                    <br><br>Caveat: for imports, when you undo, you will see Filename: None. This is not a bug, this means that you're going back to a state previous to an import. That is all.
                </p>
                <h3 id="Additional Commands">Additional Commands</h3>
                <h4>Clear all selections</h4>
                <p>
                    Sometimes, maybe you just want to see everything as it is without any selections. Or maybe, you were playing an anim, you tried making an edit and got a text in blue saying you can't do that while playing an anim, and now you can't remove it. Well, for those cases, you can select clear all selections (pun... intended?) and the texts will disappear and you'll be able to keep looking at the beautiful animation. You can also still make new selections, now only the ones you actually want. It also helps for example when you were trying to enter new values for maybe CHR fields, or palette, or anim fields, and you want the red to go away and go back to the current value. Clear all selections helps at this too.

                    <br><br>You can find it in <b><em>Edit->Clear all selections</em></b>, and you can also use it via keyboard shortcut <b><em>Ctrl+D</em></b>. It is not added to UndoRedo (not considered a change nor a navigation command, rather it is of the same type that the toggles in Anim menu, but applies for all selections in general).
                </p>
                <h3 id="Internals">Internals/Special Considerations</h3>
                <p>
                    You shouldn't have <em>any</em> other files in the Characters directory. If you have for example in the anims folder a file with a .bak extension (which HxD generates by default when you make changes and save for example), the information displayed will not be accurate, and this includes IDs. CreateAnims might say you're selecting the Anim ID 02, but you're actually selecting Anim ID 03.

                    <br><br>IDs should be ordered, and follow a 3-digit format (so maximum value allowed is 999). This means you shouldn't have 001 and then 003. If 002 is unused, you should set a dummy file (that contains the bare minimum for the type to be considered valid). For example, for an anim, it could be a file with a physics ID 00 and then just one tile 00. <em><strong>Exception</strong></em>: CHR and CHR PAL files. Those are expected to be at any order, since character CHR might be at any point in the ROM. Each CHR ID should match with the corresponding CHR PAL ID, though.

                    <br><br>An images folder will be created when you play an anim for the currently selected character. This is a cache of sorts, which means CreateAnims generates png files when you click on Play Anim and then "inserts" them/displays them, without having to regenerate or recalculate them. You can delete them if you want later, they will be regenerated anyways when you next play an anim.

                    <br><br>There are some validations in-place for file format, but only for format. There are <em>no validations on the data itself</em>. An example is putting $FF frame for an anim, where frame id $FF doesn't exist (suppose for example character has 60 frames available). The format is correct, there are at least 2 bytes. But the data itself is not. In this case, you will see a crash when you navigate to the faulty anim, but you won't see anything before. Keep that in mind (you'll still get a log history in crash_log.txt though in case you want to redo anything). There are, however, some checks like width*height has to be equal to the total amount of tiles and maximum possible values for height and width (60). This is because those errors in particular are very silent and can wreak havoc in very unpredictable ways. There is also one for physics ID mismatch which is also there for similar reasons. In general, try to follow the format as described further below.

                    <br><br>CHR is per character, not as per the ROM. And same goes for all other types. I had many thoughts about this but I went for per character because it's more flexible overall. If it was per the ROM, it'd be a lot more difficult to check for stuff like the size and you would also import stage data so it'd be more difficult to know the CHR range for a character and stuff like that (also when you save, what do you save?)... overall it just seemed like it wasn't the route I wanted to take. On the other hand, if you have two characters that use the same CHR, you will need to find a way in the ROM to make them reference the same. Maybe you can have them duplicated for the purposes of CreateAnims (and then manually/via your own scripts paste the results of one into the other), but when assembling the ROM, they both reference the same. In CreateAnims, every character has its own scope you could say and it was done that way for these reasons. Plus, it'd be a lot harder to use because you would have to first load a palette for example, and then assign it to a character.
                </p>
                    <h4>Why binaries?</h4>
                <p>
                    Why binaries? Because it makes it easier to work with the ROM (just incbin, done, vs having everything in one file and having to parse to then do incbin or then doing include and having the problems I describe after this parenthesis), but over all things, it makes things more flexible. The other approach would be for example writing to different sections of different asm files. But then, how can I know what's the format of the asm file? (example: what if the asm has all the data for one bank and in the same bank there's collisions data, or stage data, or whatever, or what if there are pointers tables, at what line should I make the insertions? what should be the name of the labels? and the list goes on and on) I would have to ask people to format their asm files in specific ways, to move data from banks into other banks and stuff like that which... if someone asked me, I just wouldn't do it. Perhaps other people wouldn't have much of a problem with it, but I do believe this is the best option to make it flexible. With binaries, you can import them literally wherever you want in the ROM. In this asm, or in this other, you have flexibility there. And well, the other reason is clarity. Both from code perspective and from a more organizational perspective, it makes more sense to me.

                    <br><br>There is an alternative approach: using session files, or files that store all the data. This can make it easier to hold different versions, different workspaces. It can also simplify sending files: instead of sending all the individual files (if for example only the programmer uses Git and so the graphics team sends the files instead of commiting and pushing to a remote repository), send the session file, with all the changes and state in just one file. But there are cons: first of all, it is harder to see the affected files. Secondly, there's an extra step of having to interpret the session file and being unable to see the changes right away. With the "multiple files" approach, you can both see exactly what files are affected, and you can right away run the build, and done, the ROM is assembled right away with all the changes. It's a similar point to the above paragraph, it simplifies the necessary incbin to finally put the updated data into the ROM.

                    <br><br>CreateAnims was built with reverse engineering at the top of priorities. That also led into this design decision. A lot of tools are built with the session files approach because they are meant to be used in a variety of contexts. So they say: "I give you the data, you write your own scripts to then insert the data into your ROM depending on your specific format" (some don't even use the concept of ROM, and can generate other kind of file types which can be used for multiple purposes). In technical terms, they create a new abstraction, where you can work on the data itself (be it graphics, music etc.) and then the specific details will vary on the specific project. For CreateAnims, the idea is that the flow is more direct: you make changes, you save those right into the project in binaries, build, done (and that's because, you are meant to reverse engineer where the files are in the ROM and then directly pass them to CreateAnims, without anything in the middle). So yes, you still need to have a certain structure in your project, but the asm files themselves can still have whatever you want.
                </p>
                </p>
                    <h4>FILE FORMAT</h4>
                <p>
                    PAL has to be exactly 8 bytes long. <u>Filename</u>: character_name/pal/character_name_usual.pal.
                    <br><br>CHR has to be exactly 2048 (2K) long. <u>Filename</u>: character_name/chr/character_name_chr_chrid.chr.
                    <br><br>CHR PAL has to be exactly 16 bytes long. <u>Filename</u>: character_name/chr/character_name_chr_pal_chrid.chr.pal.<!--I like how this looks without newlines. It's still rendered the same anyways, but I like how it looks here.-->
                    <br><br>Frame has to be at least 7 bytes long, total amount of tiles (what comes after the 6th byte) has to equal width * height. First byte is width, second is height, third is x_offset, fourth is CHR bank, fifth is y_offset, sixth is special palette ID (always 0 at least for MK3, so unused) and everything from seventh byte onwards are the tiles. Everything that comes from seventh onwards has to equal width * height, for example, if width = 1 and height = 1, then the frame must have exactly 7 bytes. Width and height cannot be more than 60, nor 0. <u>Filename</u>: character_name/frames/character_name_frame_frameid.frame.
                    <br><br>Anim has to be at least 2 bytes long, first byte is physics ID, second byte and onwards is frames. You will get a warning on navigation (not when opening the Characters directory the first time) in case the amount of frames from 2nd byte onwards doesn't match the amount of frames for the associated physics ID, and playing animations with physics will be disabled (the anim will play, but without physics). Again, the data itself is not checked, meaning, physics ID has to be one of the existent (already loaded ones) and same for frames. <u>Filename</u>: character_name/anims/character_name_anim_animid.anim.
                    <br><br>Physics must be exactly an odd number and end with an $80. The first byte is the <em>relative</em> X and second byte is the <em>relative</em> Y. Relative here means how much you'll move each frame with respect to your current position. If physics file contains $05, $05, $05, $05, $80, it doesn't mean move to 5 and stay there, it means move 5 both in X and Y two times, and then end. <u>Filename</u>: physics/physics_physicsid.physics.
                </p>
            </div>
            <div class="banner-divider"></div>
        </div>
    </body>
</html>
